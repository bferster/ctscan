<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/jquery-ui.min.css"></link>
	<script src="lib/jquery.min.js"></script>
	<script src="lib/jquery-ui.min.js"></script>
	<!-- script src="lib/jquery.ui.touch-punch.min.js"></script -->
 	<script src="app.js"></script>
	<link REL="SHORTCUT ICON" HREF="img/favicon.ico">
	<title>CTScan</title>
	<style type="text/css">
		 body { 			font-family: Verdana,Geneva,sans-serif; font-size:13px; box-sizing: border-box;
							padding: 0px; margin: 0px; 

							}
		.ct-obsPanel {		background-color:#ddd; border-radius: 6px; margin:12px; padding: 12px; width:50%; width: 360px;
		margin-left: auto;
  margin-right: auto;
							}
		.ct-obsCat {		font-size: 20px; font-weight: bold; color: #000; margin-top: 8px; margin-bottom: 6px;
							}
		.ct-obsTime {		font-size: 20px; border-radius: 6px; background-color: #fff; text-align:center; width: 120px;
							border: 1px solid #ccc; display: inline-block;
							}
		.ct-obsStart {		font-size: 20px; cursor: pointer; vertical-align: -6px; width: 18px; margin-left: 8px;
							}
		.ct-obsPrac {		cursor: pointer; vertical-align: -6px; margin-left: 67px; 
							}
		.ct-obsPracText {	font-size: 14px; color: #000099; font-weight: bold; margin-top: 4px; margin-bottom: 8px;
							}
		.ct-obsPracOps {	font-size: 13px;
							}
		.ct-event {			width:80px; height:80px;  margin-bottom: 4px; cursor: pointer;
							}
		.ct-count {			cursor: zoom-out;
							}
		.ct-count:hover {	color: #333;
							}
		.ct-mediaNotes 	{	margin-top: 8px; margin-bottom: 6px; 
							}
		.ct-mediaRow1 	{	width: 168px; 
							}
		.ct-notes 	{		width: 336px; border-radius:4px; padding-left:8px;border: 1px solid #999;
		 					margin-top: 8px;
							}


		.ui-dialog-buttonpane.ui-widget-content.ui-helper-clearfix { border:none }
		.ui-dialog { border-radius:12px;box-shadow:2px 2px 6px #ccc }
		.ui-button { border-radius:30px;outline:none }
		.ui-dialog-titlebar { display:none }
		 table {			border-spacing: 0px;  }
</style>
</head>
<body>
	<div id="obsPanel" class="ct-obsPanel">
		<div id="obsCat" class="ct-obsCat">Phonics Instruction</div>
		<div id="obsTime" class=""> 
			<div id=" obs-time" class="ct-obsTime">00:12</div>
			<img id="obsStart" src="img/playbut.png" class="ct-obsStart">
				<div  id="obsPrac" class="btn-group">
				<button type="button" class="btn-sm btn-primary dropdown-toggle ct-obsPrac" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Set practice</button>
				<div id="obsPracOpts" class="dropdown-menu ct-obsPracOps"></div>
			</div>			
		</div>	
		<div class="ct-obsPracText" id="obsPracText" >No practice set yet...</div>

		<div id="obsEvt">
			<div id="ev-1" class="btn btn-success ct-event "><span id="evl-1"></span><span class="ct-count" id="evc-1"><br></span></div> 
			<div id="ev-2" class="btn btn-success ct-event "><span id="evl-2"></span><span class="ct-count" id="evc-2"><br></span></div> 
			<div id="ev-3" class="btn btn-success ct-event "><span id="evl-3"></span><span class="ct-count" id="evc-3"><br></span></div> 
			<div id="ev-4" class="btn btn-success ct-event "><span id="evl-4"></span><span class="ct-count" id="evc-4"><br></span></div><br> 
			<div id="ev-5" class="btn btn-info ct-event "><span id="evl-5"></span><span class="ct-count" id="evc-5"><br></span></div> 
			<div id="ev-6" class="btn btn-info ct-event "><span id="evl-6"></span><span class="ct-count" id="evc-6"><br></span></div> 
			<div id="ev-7" class="btn btn-info ct-event "><span id="evl-7"></span><span class="ct-count" id="evc-7"><br></span></div> 
			<div id="ev-8" class="btn btn-info ct-event "><span id="evl-8"></span><span class="ct-count" id="evc-8"><br></span></div><br> 
			<div id="ev-9" class="btn btn-warning ct-event "><span id="evl-9"></span><span class="ct-count" id="evc-9"><br></span></div> 
			<div id="ev-10" class="btn btn-warning ct-event "><span id="evl-10"></span><span class="ct-count" id="evc-10"><br></span></div> 
			<div id="ev-11" class="btn btn-warning ct-event "><span id="evl-11"></span><span class="ct-count" id="evc-11"><br></span></div> 
			<div id="ev-12" class="btn btn-warning ct-event "><span id="evl-12"></span><span class="ct-count" id="evc-12"><br></span></div> 
			</div>
		<div id="obsMedia" class="ct-mediaNotes">
			<table>
				<tr><td class="ct-mediaRow1"><input id="md-1" type="checkbox"> Diagram/Graph</input></td>
				<td><input id="md-2" type="checkbox"> Object/Manipulative</input></td></tr>
				<tr><td class="ct-mediaRow1"><input id="md-3" type="checkbox"> Graphic Organizer</input></td>
				<td><input id="md-4" type="checkbox"> Picture</input></td></tr>
				<tr><td class="ct-mediaRow1"><input id="md-5" type="checkbox"> Movie</input></td>
				<td><input id="md-6" type="checkbox"> Text</input></td></tr>
			</table>
			<input id="obsNote" class="ct-notes" type="text" placeholder="Type note. Press enter to save"></input><br>
			<input class="ct-notes" type="text" placeholder="Type new topic/vocab word. Press enter to save"></input>
		</div>
	</div> <!-- ObsPanel --> 
		<button id="obsDone" type="button" class="btn-sm btn-danger">Done</button>

<script>

//////////////////////////////////////////////////////////////////////////////////////////////////
// MAIN 
/////////////////////////////////////////////////////////////////////////////////////////////////

var app=null;
var curTime=0;
var inPlay=false;

$(window).resize(function() {                                         	// ON WINDOW RESIZE
	if (app && app.allowResize)												// If app loaded and allowing resizing
		app.Draw();															// Redraw to fit screen
	});
			
$(document).ready(function() {								           	// ON PAGE LOADED
	var url=window.location.search.substring(1);						   	// Get query string
//	app=new App();                                                      	// Alloc app
	InitHandlers();
    });	

	function InitHandlers() {

		var i;
		var labs=["Deep<br>Q QTR","Rote<br>Q OTR","Choral<br>Resp","So/Be<br>OTR",
				  "Acad<br>FB", "Behav<br>FB","Gen<br>FB","Stud<br>Ask Q",
				  "# Stud<br>Ask Q","Cust<br>1","Cust<br>2","Cust<br>3"
				 ];
		var dataLabs=["Deep Q OTR","Rote Q OTR","Choral Response","Social Behavioral OTR",
					  "Academic Specific FB","Behavior Specific FB","Generic FB Statement","Student Ask Q",
					  "Num Student Ask Q","Custom","Custom","Custom"
					 ];

		var dataPrac=["Alphabet activities","Blending/segmenting compound words",
					 "Blending/segmenting onset-rime","Blending/segmenting phonemes",
					 "Blending/segmenting syllables","Counting/Clapping syllables",
					 "Deleting/substituting phonemes","Identifying letters",
					 "Learning sounds ","Learning spelling words","Matching sounds to letters",
					 "Nonsense words","Reading words","Strategy to sound out unknown words",
					 "Word family activities","Word study (learning word patterns)","Writing letters"
					 ];
		var dataMedia=["Diagram/Graph","Object/Manipulative","Graphic Organizer","Picture","Movie","Text"
					  ];


		for (i=0;i<dataPrac.length;++i)	{									// For each practice
			$("#obsPracOpts").append('<li id="obsdp-'+i+'"class="dropdown-item">'+dataPrac[i]+'</li>')
			$("#obsdp-"+i).on("click", function(e) {						// On practice click
				var id=e.currentTarget.id.substr(6);						// Get id
			$("#obsPracText").text(dataPrac[id]);							// Set new practice text
			});
			}
		for (i=1;i<7;++i) {													// For each media
			$("#md-"+i).on("click", function(e) {							// On box click
				var act=$(this).prop("checked") ? "active" : "inactive";	// Active
				var id=e.currentTarget.id.substr(3)-1;						// Get id			
				SaveEvent(curTime,"Visual Aid",dataMedia[id],act,0);		// Save event
				});
			}
		
		for (i=1;i<13;++i) {												// For each event button
			$("#evl-"+i).html(labs[i-1]+"<br>");							// Set label

			$("#ev-"+i).on("click", function(e) {							// On event button click
				var id=e.currentTarget.id.substr(3);						// Get id			
				var c=1;													// First one												
				var s=$("#evc-"+id).text();									// Get count from label
				if (s)	c=s.substr(1,s.length-2)-0+1						// If not first, get and increment
				$("#evc-"+id).html("("+c+")");								// Show new count
				Sound("click");												// Click sound	
				var p1="Custom";											// Assume custom
				if (id < 5)			p1="OTR";								// Set category
				else if (id < 8)	p1="FB";
				else if (id < 10)	p1="Student Q";
				SaveEvent(curTime,p1,dataLabs[id-1],"",0);					// Save event
				});

			$("#evc-"+i).on("click", function(e) {							// On event button click
				e.stopPropagation();										// Stop propagation
				var id=e.currentTarget.id.substr(4);						// Get id			
				var s=$("#evc-"+id).text();									// Get count from label
				var c=s.substr(1,s.length-2)-1								// If not first, get and decrement
				if (c)														// Something to show
					$("#evc-"+id).html("("+c+")");							// Show new count
				else														// No counts
					$("#evc-"+id).html("");									// Clear display
				Sound("delete");											// Delete sound	
				if (id < 5)			p1="OTR";								// Set category
				else if (id < 8)	p1="FB";
				else if (id < 10)	p1="Student Q";
				SaveEvent(curTime,p1,dataLabs[id],"NEGATE",0);				// Save event
				});

		}

		$("#obsStart").on("click", function(e) {							// On start/pause button click
			inPlay=!inPlay;													// Toggle state
			SetPlayMode(inPlay);											// Set play mode
			});
		
		$("#obsNote").on("changed", function(e) {								// On Note enty
trace(122)
			});





	}


	function SetPlayMode(mode) {
		if (inPlay)	{
			$("#obsStart").prop("src","/img/pausebut.png");					// Pause but		
			Sound("click");													// Click sound	
			}
		else {		
			$("#obsStart").prop("src","/img/playbut.png");					// Play but		
			Sound("delete");												// Delete sound	
		}


	}

	function ShowTime()
	{
	}

	function SaveEvent(time, p1, p2, p3, p4)
	{
		trace(time+","+p1+","+p2+","+p3+","+p4);
	}




////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// HELPERS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	function DialogBox(title, content, width, callback, callback2) 			// DIALOG BOX
	{
		$("#dialogDiv").remove();												
		$("body").append("<div class='unselectable' id='dialogDiv'></div>");														
		var str="<p><img src='img/logo32.png' style='vertical-align:-10px'/>&nbsp;&nbsp;";								
		str+="<span id='gtBoxTi'style='font-size:18px;text-shadow:1px 1px #ccc;color:#666'><b>"+title+"</b></span><p>";
		str+="<div style='font-size:14px;margin:14px'>"+content+"</div>";
		$("#dialogDiv").append(str);	
		$("#dialogDiv").dialog({ width:Math.abs(width), buttons: {
					            	"OK": 		function() { if (callback)
					            								callback(); 
					            								$(this).remove();  
					            								},
					            	"Cancel":  	function() { if (callback2)	            		
					            								callback2();
					            								$(this).remove(); }
									}});	
		if (width < 0)
			$("#dialogDiv").dialog("option","position",{ my:"left top", at:"left top", of:this.parent });
		else
			$("#dialogDiv").dialog("option","position",{ my:"center", at:"center", of:this.parent });
	}


	function trace(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
	}

	function Sound(sound, mute)												// PLAY SOUND
	{
		var snd=new Audio();													// Init audio object
		if (!snd.canPlayType("audio/mpeg") || (snd.canPlayType("audio/mpeg") == "maybe")) 
			snd=new Audio("img/"+sound+".ogg");									// Use ogg
		else	
			snd=new Audio("img/"+sound+".mp3");									// Use mp3
		if (!mute)	{															// If not initing or muting	
			snd.volume=50/100;													// Set volume
			snd.play();															// Play it
			}
		}
		
	function ButtonPress(id)												// WIGGLE BUTTON
	{
		Sound("click");
		var p=$("#"+id).offset();
		$("#"+id).animate( { left: p.left+1+"px", top: p.top+1+"px"}, 50, 
			function() {$("#"+id).css( { left: p.left+"px", top: p.top+"px"})} 
			);
	}

</script>
</body>
</html>
